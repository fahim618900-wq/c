<!DOCTYPE html>
<html>
<head>
    <title>‡¶´‡ßç‡¶∞‡¶ø ‡¶á‡¶Æ‡ßá‡¶ú ‡¶Ü‡¶™‡¶≤‡ßã‡¶° - Unlimited</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #333; margin-bottom: 30px; font-size: 28px; }
        .upload-area { border: 3px dashed #667eea; border-radius: 15px; padding: 40px; text-align: center; margin-bottom: 20px; cursor: pointer; transition: 0.3s; }
        .upload-area:hover { background: #f0f4ff; border-color: #764ba2; }
        .upload-area.dragover { background: #e0e7ff; border-color: #4f46e5; }
        #fileInput { display: none; }
        .upload-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 18px; cursor: pointer; width: 100%; margin-top: 20px; transition: 0.3s; }
        .upload-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4); }
        .upload-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .preview { max-width: 100%; max-height: 300px; margin: 20px auto; display: block; border-radius: 10px; display: none; }
        .link-container { margin-top: 20px; }
        #imageLink { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; margin-top: 10px; }
        .copy-btn { background: #10b981; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; margin-top: 10px; width: 100%; }
        .stats { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee; }
        .stat-box { text-align: center; }
        .stat-number { font-size: 24px; font-weight: bold; color: #667eea; }
        .stat-label { font-size: 14px; color: #666; }
        .loader { display: none; border: 5px solid #f3f3f3; border-top: 5px solid #667eea; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .message { padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; display: none; }
        .success { background: #d1fae5; color: #065f46; border: 2px solid #10b981; }
        .error { background: #fee2e2; color: #991b1b; border: 2px solid #ef4444; }
        @media (max-width: 600px) { .container { padding: 20px; } h1 { font-size: 24px; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± ‡¶´‡ßç‡¶∞‡¶ø ‡¶á‡¶Æ‡ßá‡¶ú ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</h1>
        <h3 style="text-align: center; color: #666; margin-bottom: 20px;">‡¶Ü‡¶®‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü‡ßá‡¶° ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú - ‡ßß‡ß¶‡ß¶% ‡¶´‡ßç‡¶∞‡¶ø</h3>
        
        <div class="upload-area" id="dropArea">
            <div style="font-size: 60px; color: #667eea;">üì§</div>
            <p style="font-size: 18px; color: #555; margin: 10px 0;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶°‡ßç‡¶∞‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
            <p style="color: #888;">‡¶¨‡¶æ</p>
            <button class="upload-btn" onclick="document.getElementById('fileInput').click()">‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <input type="file" id="fileInput" accept="image/*">
        </div>
        
        <img id="preview" class="preview" alt="Preview">
        
        <div class="loader" id="loader"></div>
        
        <button class="upload-btn" id="uploadBtn" onclick="uploadImage()" disabled>‡¶á‡¶Æ‡ßá‡¶ú ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        
        <div class="message" id="message"></div>
        
        <div class="link-container" id="linkContainer" style="display: none;">
            <h3 style="color: #333; margin-bottom: 10px;">‚ú® ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≤‡¶ø‡¶Ç‡¶ï:</h3>
            <input type="text" id="imageLink" readonly>
            <button class="copy-btn" onclick="copyLink()">üìã ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-number" id="fileCount">0</div>
                <div class="stat-label">‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="totalSize">0 MB</div>
                <div class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">‡¶´‡ßç‡¶∞‡¶ø</div>
                <div class="stat-label">‡¶ñ‡¶∞‡¶ö</div>
            </div>
        </div>
    </div>

    <script>
        // Configuration - ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Cloudflare R2 ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏
        const R2_CONFIG = {
            accountId: 'YOUR_CLOUDFLARE_ACCOUNT_ID',
            bucketName: 'YOUR_BUCKET_NAME',
            accessKeyId: 'YOUR_ACCESS_KEY_ID',
            secretAccessKey: 'YOUR_SECRET_ACCESS_KEY'
        };

        let selectedFile = null;
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const preview = document.getElementById('preview');
        const uploadBtn = document.getElementById('uploadBtn');
        const loader = document.getElementById('loader');
        const message = document.getElementById('message');
        const linkContainer = document.getElementById('linkContainer');
        const imageLink = document.getElementById('imageLink');

        // Drag and Drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => {
                dropArea.classList.add('dragover');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => {
                dropArea.classList.remove('dragover');
            }, false);
        });

        dropArea.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', handleFileSelect, false);

        function handleDrop(e) {
            const files = e.dataTransfer.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            if (files.length > 0) {
                selectedFile = files[0];
                
                // File validation
                const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
                if (!validTypes.includes(selectedFile.type)) {
                    showMessage('‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ JPG, PNG, GIF, WebP ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
                    return;
                }
                
                if (selectedFile.size > 10 * 1024 * 1024) { // 10MB limit
                    showMessage('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú 10MB ‡¶è‡¶∞ ‡¶ï‡¶Æ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá', 'error');
                    return;
                }
                
                // Show preview
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(selectedFile);
                
                uploadBtn.disabled = false;
            }
        }

        async function uploadImage() {
            if (!selectedFile) return;
            
            loader.style.display = 'block';
            uploadBtn.disabled = true;
            message.style.display = 'none';
            
            try {
                // Generate unique filename
                const fileExt = selectedFile.name.split('.').pop();
                const fileName = `${Date.now()}-${Math.random().toString(36).substr(2, 9)}.${fileExt}`;
                
                // Create form data
                const formData = new FormData();
                formData.append('image', selectedFile);
                formData.append('filename', fileName);
                
                // Upload to server (you'll need to create a serverless function)
                // For now using mock response
                const mockUrl = await mockUpload(selectedFile, fileName);
                
                // Display link
                imageLink.value = mockUrl;
                linkContainer.style.display = 'block';
                
                // Update stats
                updateStats(selectedFile.size);
                
                showMessage('‚úÖ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!', 'success');
                
                // Reset for next upload
                selectedFile = null;
                preview.style.display = 'none';
                uploadBtn.disabled = true;
                
                // Scroll to link
                linkContainer.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                showMessage('‚ùå ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ' + error.message, 'error');
                uploadBtn.disabled = false;
            } finally {
                loader.style.display = 'none';
            }
        }

        // Mock upload function - Replace with actual Cloudflare R2 upload
        async function mockUpload(file, filename) {
            // In real implementation, upload to Cloudflare R2
            // For demo, return a mock URL
            return `https://your-subdomain.workers.dev/images/${filename}`;
        }

        function copyLink() {
            imageLink.select();
            imageLink.setSelectionRange(0, 99999);
            document.execCommand('copy');
            
            const btn = document.querySelector('.copy-btn');
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!';
            btn.style.background = '#059669';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '#10b981';
            }, 2000);
        }

        function showMessage(text, type) {
            message.textContent = text;
            message.className = `message ${type}`;
            message.style.display = 'block';
        }

        function updateStats(fileSize) {
            const fileCountEl = document.getElementById('fileCount');
            const totalSizeEl = document.getElementById('totalSize');
            
            let count = parseInt(fileCountEl.textContent) + 1;
            let size = parseFloat(totalSizeEl.textContent) + (fileSize / (1024*1024));
            
            fileCountEl.textContent = count;
            totalSizeEl.textContent = size.toFixed(2) + ' MB';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Check if PWA can be installed
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js');
            }
            
            // Add to home screen prompt
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
            });
        });
    </script>
</body>
</html>
